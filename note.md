ç»“åˆä½ æä¾›çš„ `package.json` å†…å®¹å’Œ GitHub Actions å·¥ä½œæµæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæ•´åœ°ç†è§£è¿™ä¸ªè‡ªåŠ¨åŒ–æµç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š

### GitHub Actions å·¥ä½œæµ (`ci`):

- **è§¦å‘å™¨**: 
  - **schedule**: å·¥ä½œæµåœ¨æ¯å¤©æ™šä¸Š 23:00 (UTC) è‡ªåŠ¨è§¦å‘ã€‚
  - **workflow_dispatch**: å…è®¸æ‰‹åŠ¨ä» GitHub UI ç•Œé¢è§¦å‘ã€‚

- **Jobs**: 
  - **CreateImage**:
    - **runs-on**: åœ¨ Ubuntu çš„æœ€æ–°ç‰ˆæœ¬ä¸Šè¿è¡Œã€‚
    - **permissions**: å…è®¸å†™å…¥ä»“åº“å†…å®¹ã€‚
    - **strategy**: ä½¿ç”¨ Node.js ç‰ˆæœ¬ 18ã€‚

**æ­¥éª¤**:

1. **Checkout ğŸ›ï¸**: 
   - æ£€å‡ºä»£ç åˆ°å·¥ä½œæœºä¸Šã€‚(å°†ä½ çš„ä»“åº“ä»£ç ä» GitHub ä¸Šæ‹‰å–åˆ°å·¥ä½œæµè¿è¡Œçš„è™šæ‹Ÿæœºä¸Š)

2. **Install PNPM**: 
   - å®‰è£… `pnpm` åŒ…ç®¡ç†å™¨ã€‚

3. **Install Deps**: 
   - å®‰è£…é¡¹ç›®ä¾èµ–ã€‚

4. **Build**: 
   - è¿è¡Œ `pnpm run build` å‘½ä»¤ï¼Œæ ¹æ® `package.json` ä¸­çš„å®šä¹‰ï¼Œè¿™ä¼šå…ˆç”¨ TypeScript ç¼–è¯‘ï¼ˆä½†ä¸è¾“å‡ºæ–‡ä»¶ï¼‰ï¼Œç„¶åç”¨ `esbuild` å°† `bin/cli.ts` æ‰“åŒ…åˆ° `dist` ç›®å½•ã€‚

5. **Create Image**: 
   - è¿è¡Œ `pnpm run start --cookie "${{ secrets.BING_COOKIE }}"`ã€‚æ ¹æ® `package.json` ä¸­ `"start": "node dist/cli.js"`ï¼Œè¿™å®é™…ä¸Šæ˜¯æ‰§è¡Œ `dist/cli.js`ï¼Œå¹¶ä¼ é€’ä¸€ä¸ª `cookie` å‚æ•°ã€‚`dist/cli.js` æ˜¯ `bin/cli.ts` ç¼–è¯‘åçš„äº§ç‰©ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«äº† `init()` å‡½æ•°çš„è°ƒç”¨æˆ–æ˜¯è§¦å‘ `init()` çš„é€»è¾‘ã€‚

6. **Push New Pic**: 
   - é…ç½® Git å‡­è¯å¹¶æ‰§è¡Œ Git æ“ä½œï¼Œå°†ç”Ÿæˆçš„å›¾ç‰‡ï¼ˆå¦‚æœæœ‰å˜åŒ–ï¼‰æäº¤å¹¶æ¨é€åˆ°ä»“åº“ã€‚

### ç»“åˆ `package.json`:

- **å…¥å£ç‚¹**: `cli.js` æ˜¯é¡¹ç›®å…¥å£ç‚¹ï¼Œä½†å®é™…ä¸Šæ˜¯ `dist/cli.js` è¢«æ‰§è¡Œï¼Œå› ä¸º `start` è„šæœ¬æŒ‡å‘äº†è¿™ä¸ªæ–‡ä»¶ã€‚
- **æ„å»ºè¿‡ç¨‹**: `build` è„šæœ¬ç¼–è¯‘å¹¶æ‰“åŒ… `bin/cli.ts` åˆ° `dist` ç›®å½•ï¼Œç”Ÿæˆ `dist/cli.js`ã€‚
- **init() å‡½æ•°**: å¦‚æœ `init()` æ˜¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¾ˆå¯èƒ½åœ¨ `bin/cli.ts` ä¸­è¢«å®šä¹‰æˆ–è°ƒç”¨ï¼Œæˆ–è€…åœ¨ `cli.js` ä¸­é€šè¿‡æŸç§æ–¹å¼è¢«è§¦å‘ã€‚

### æ€»ç»“ï¼š

å½“å·¥ä½œæµè§¦å‘æ—¶ï¼Œ`bin/cli.ts` ä¼šè¢«ç¼–è¯‘å’Œæ‰“åŒ…æˆ `dist/cli.js`ï¼Œç„¶åé€šè¿‡ `pnpm run start` æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚`init()` å‡½æ•°çš„æ‰§è¡Œå¯èƒ½ç›´æ¥åœ¨ `cli.ts` æˆ–é€šè¿‡æŸä¸ªæ¨¡å—å¯¼å…¥çš„æ–¹å¼åœ¨ `dist/cli.js` ä¸­è¢«è°ƒç”¨ã€‚æ•´ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–äº†å›¾ç‰‡çš„ç”Ÿæˆã€æäº¤å’Œæ¨é€ï¼Œç¡®ä¿æ¯å¤©å®šæ—¶æ›´æ–°ä»“åº“ä¸­çš„å†…å®¹ã€‚




```text
main å­—æ®µæŒ‡å®šäº†é¡¹ç›®çš„å…¥å£æ–‡ä»¶æ˜¯ cli.jsã€‚è¿™æ„å‘³ç€å½“ä½ ç›´æ¥è¿è¡Œ node . æˆ– npm start æ—¶ï¼ŒNode.js ä¼šå°è¯•æ‰§è¡Œ cli.js æ–‡ä»¶ã€‚

"start": "node dist/cli.js"ï¼šè¿™è¡¨æ˜ pnpm run start å‘½ä»¤ä¼šæ‰§è¡Œ dist/cli.js æ–‡ä»¶ã€‚dist/cli.js å¾ˆå¯èƒ½æ˜¯é€šè¿‡ TypeScript ç¼–è¯‘è€Œæ¥ï¼Œå› ä¸ºä½ æœ‰ build è„šæœ¬ä½¿ç”¨äº† TypeScript å’Œ esbuildã€‚

# è¿™ä¸ªè„šæœ¬å…ˆç”¨ TypeScript ç¼–è¯‘ï¼ˆä½†ä¸è¾“å‡ºä»»ä½•æ–‡ä»¶ï¼‰ï¼Œç„¶åä½¿ç”¨ esbuild å°† bin/cli.ts æ–‡ä»¶æ‰“åŒ…åˆ° dist ç›®å½•ä¸‹ã€‚
"build": "tsc --noEmit && esbuild \"bin/cli.ts\" --bundle --platform=node --target=node16 --outdir=dist",
```
